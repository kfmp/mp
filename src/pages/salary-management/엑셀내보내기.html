<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.2/xlsx.full.min.js"></script>
  </head>
  <body>
    <button id="export-excel">Export to Excel</button>
    <table id="data-table">
      <tr>
        <td>Data 1</td>
        <td>Data 2</td>
      </tr>
      <tr>
        <td>Data 3</td>
        <td>Data 4</td>
      </tr>
    </table>
    <input type="file" id="input-excel" />
    <table id="excel-table"></table>
    <script>
      document
        .getElementById('export-excel')
        .addEventListener('click', function () {
          const table = document.getElementById('data-table');
          const workbook = XLSX.utils.table_to_book(table);
          XLSX.writeFile(workbook, 'output.xlsx');
        });

      document
        .getElementById('input-excel')
        .addEventListener('change', function (event) {
          const file = event.target.files[0];
          if (!file) return;

          const reader = new FileReader();
          reader.onload = function (e) {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, { type: 'array' });

            const firstSheetName = workbook.SheetNames[0];
            const worksheet = workbook.Sheets[firstSheetName];
            const json = XLSX.utils.sheet_to_json(worksheet, { header: 1 });

            const table = document.getElementById('excel-table');
            table.innerHTML = '';
            json.forEach((row) => {
              const tr = document.createElement('tr');
              row.forEach((cell) => {
                const td = document.createElement('td');
                td.textContent = cell;
                tr.appendChild(td);
              });
              table.appendChild(tr);
            });
          };
          reader.readAsArrayBuffer(file);
        });
    </script>
  </body>
</html>
